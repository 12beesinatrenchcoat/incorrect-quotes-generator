var m=Object.defineProperty;var a=Object.getOwnPropertySymbols;var h=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var u=(o,t,e)=>t in o?m(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,f=(o,t)=>{for(var e in t||(t={}))h.call(t,e)&&u(o,e,t[e]);if(a)for(var e of a(t))w.call(t,e)&&u(o,e,t[e]);return o};var p=(o,t,e)=>new Promise((n,d)=>{var c=r=>{try{i(e.next(r))}catch(l){d(l)}},s=r=>{try{i(e.throw(r))}catch(l){d(l)}},i=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,s);i((e=e.apply(o,t)).next())});const promptSetList={};window.fetchedPromptSets={};const prompts={};window.filteredPrompts={};const tags={};fetch("./promptSetList.json").then(o=>o.json()).then(o=>{Object.keys(o).forEach(t=>{promptSetList[t]=o[t]})}).then(()=>{Object.keys(promptSetList).forEach(o=>{addPromptSetToSelector(o)}),document.querySelector("#prompt-sets-loading").hidden=!0});const promptSetSelector=document.querySelector("#prompt-set-selector");function addPromptSetToSelector(o){const t=promptSetList[o],e=document.createElement("input");e.type="checkbox",e.id=o,e.className="prompt-set",e.addEventListener("input",c=>p(this,null,function*(){const{target:s}=c,i=s.id;s.checked?(s.indeterminate=!0,yield window.fetchPromptSet(promptSetList[i].path,i),s.indeterminate=!1,Object.keys(window.fetchedPromptSets[i].prompts).forEach(r=>{prompts[r]||(prompts[r]=[]),prompts[r]=[...prompts[r],...window.fetchedPromptSets[i].prompts[r]]})):Object.keys(prompts).forEach(r=>{prompts[r]=prompts[r].filter(l=>l.set!==i)}),updateFilteredPrompts()}));const n=document.createElement("label");n.appendChild(e);const d=document.createElement("strong");if(d.textContent=t.title,n.appendChild(d),n.append(" "+t.description+" "),t.url){const c=document.createElement("a");c.textContent="Source",c.href=t.url,n.append(c)}promptSetSelector.appendChild(n)}const promptSetup=(o,t)=>{o.set=t,o.tags&&o.tags.forEach(e=>{tags[e]||(tags[e]={enabled:!0},addTagToList(e))})},promptCounter=document.querySelector("#prompt-count"),generateQuoteButton=document.querySelector("#generate-quote");function updatePromptCounter(){let o=0;runOnAllPrompts(window.filteredPrompts,()=>{o++}),promptCounter.textContent=`${o>0?o:"no"} prompt${o===1?"":"s"}`,o===0?generateQuoteButton.disabled=!0:generateQuoteButton.disabled=!1}function runOnAllPrompts(o,t){return Object.keys(o).forEach(e=>{o[e].forEach(n=>t(n))}),o}window.fetchPromptSet=(o,t)=>p(this,null,function*(){window.fetchedPromptSets[t]?console.debug(`${promptSetList[t].title} already fetched...`):yield fetch(o).then(e=>e.json()).then(e=>{promptSetList[t]||(promptSetList[t]={title:e.title,description:e.description,url:e.url,path:o}),Object.keys(e.prompts).forEach(n=>{e.prompts[n].forEach(d=>promptSetup(d,t))}),window.fetchedPromptSets[t]=e,console.debug(`fetched ${promptSetList[t].title}!`,e)}),document.querySelector("#"+t)||addPromptSetToSelector(t)});const tagList=document.querySelector("#tag-list");function addTagToList(o){Object.keys(tags).length>0&&(document.querySelector("#tag-list-empty").hidden=!0);const t=document.createElement("span");t.className="tag";const e=document.createElement("input");e.type="checkbox",e.id=o,e.checked=!0,e.addEventListener("input",d=>{const{target:c}=d;tags[c.id].enabled=c.checked,c.checked?updateFilteredPrompts():console.debug(`filtered out ${filterPromptsByTag(c.id)} prompts with tag ${c.id}!`)}),t.appendChild(e);const n=document.createElement("label");n.htmlFor=o,n.append(o),t.appendChild(n),tagList.appendChild(t)}function filterPromptsByTag(o){let t=0;return Object.keys(window.filteredPrompts).forEach(e=>{window.filteredPrompts[e]=window.filteredPrompts[e].filter(n=>n.tags&&n.tags.includes(o)?(t++,!1):!0)}),updatePromptCounter(),t}function updateFilteredPrompts(){let o=0;const t=[];window.filteredPrompts=f({},prompts),Object.keys(tags).forEach(e=>{tags[e].enabled||(t.push(e),o+=filterPromptsByTag(e))}),console.debug(`reset window.filteredPrompts, and filtered ${t.length>0?`${o} prompts with tags [${t.join(", ")}]`:"nothing"}!`),updatePromptCounter()}
